<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="Keywords" content="blog"/>
    <meta name="Description" content="blog"/>
    <title>Simple</title>
    <link rel="shortcut icon" href="/static/favicon.png"/>
    <link rel="stylesheet" type="text/css" href="/main.css" />
</head>
<body>
<div class="main">
    <div class="header">
    	<ul id="pages">
            <li><a href="/">home</a></li>
            <li><a href="/#/tags">tags</a></li>
            <li><a href="/#/archive">archive</a></li>
    	</ul>
    </div>
	<div class="wrap-header">
    <h1>
    <a href="/" id="title"></a>
    </h1>
	</div>
<xmp id="md" style="display: none;">
<!-- markdown -->
## lcx

```
client: lcx.exe -listen 8888 1234
server: lcx.exe -slave 192.168.1.100 8888 127.0.0.1 3389
```

## ew

### 正向 socks 代理

```
server: ew.exe -s ssocksd -l 1080
```

### 反向 socks 代理

```
client: ew.exe -s rcsocks -l 10080 -e 8888
server: ew.exe -s rssocks -d 192.168.1.100 -e 8888
```

### 端口转发

```
client: ew.exe -s lcx_listen -l 1234 -e 8888
server: ew.exe -s lcx_slave -d 192.168.1.100 -e 8888 -f 127.0.0.1 -g 3389
```

### 多级级联

```
a: 192.168.1.100
b: 192.168.1.101,10.0.0.1
c: 10.0.0.2,172.16.0.1
d: 172.16.0.2
```

```
a: ew.exe -s lcx_listen -l 1234 -e 8888
b: ew.exe -s lcx_slave -d 192.168.1.100 -e 8888 -f 10.0.0.2  -g 9999
c: ew.exe -s lcx_tran -l 9999 -f 172.16.0.2 -g 3389
```

## netsh

原理同 ew 中的 `lcx_tran`

重启后依然生效

```
netsh interface portproxy set v4tov4 listenaddress=192.168.1.101 listenport=1234 connectaddress=10.0.0.1 connectport=3389
```

删除

```
netsh interface portproxy delete v4tov4 listenaddress=192.168.1.101 listenport=1234
```

关闭防火墙

```
netsh firewall set opmode disabled
```

## portmap

垃圾

listen

```
client: ./portmap -m 2 -p1 1234 -p2 8888
```

slave

```
server: ./portmap -m 3 -h1 192.168.1.100 -p1 8888 -h2 127.0.0.1 -p2 3389
```

tran

```
server: ./portmap -m 1 -p1 1234 -h2 127.0.0.1 -p2 3389
```

## ssh

```
a: 192.168.1.100
b: 192.168.1.101,10.0.0.1
c: 10.0.0.2
```

### 本地端口转发

```
a: ssh  -CfNg -L 1234:10.0.0.2:3389 root@192.168.1.101
```

a 上 1234 端口的数据通过 b 被转发到 c 上的 3389 端口

### 远程端口转发

```
a: ssh CfNg -R 1234:192.168.1.100:3389 root@192.168.1.101
```

b 的 1234 端口的数据被转发到 a 上的 3389 端口, c 作为客户端访问 b

### socks 代理

```
a: ssh -qTfnN -D 1080 192.168.1.101
```

a 上架设 socks 代理, 端口 1800, 数据通过 b 转发到内网的任何一台机器上

## portfwd

```
portfwd add -l 1234 -r 192.168.1.100 -p 3389
```

删除

```
portfwd del -l 1234
```

## reDuh reGeorg Tunna

略
<!-- markdown end -->
</xmp>
<div class="entry" id="main">
<!-- content -->
<h2 id="lcx">lcx</h2>

<pre><code>client: lcx.exe -listen 8888 1234
server: lcx.exe -slave 192.168.1.100 8888 127.0.0.1 3389
</code></pre>

<h2 id="ew">ew</h2>

<h3 id="socks">正向 socks 代理</h3>

<pre><code>server: ew.exe -s ssocksd -l 1080
</code></pre>

<h3 id="socks">反向 socks 代理</h3>

<pre><code>client: ew.exe -s rcsocks -l 10080 -e 8888
server: ew.exe -s rssocks -d 192.168.1.100 -e 8888
</code></pre>

<h3 id="">端口转发</h3>

<pre><code>client: ew.exe -s lcx_listen -l 1234 -e 8888
server: ew.exe -s lcx_slave -d 192.168.1.100 -e 8888 -f 127.0.0.1 -g 3389
</code></pre>

<h3 id="">多级级联</h3>

<pre><code>a: 192.168.1.100
b: 192.168.1.101,10.0.0.1
c: 10.0.0.2,172.16.0.1
d: 172.16.0.2
</code></pre>

<pre><code>a: ew.exe -s lcx_listen -l 1234 -e 8888
b: ew.exe -s lcx_slave -d 192.168.1.100 -e 8888 -f 10.0.0.2  -g 9999
c: ew.exe -s lcx_tran -l 9999 -f 172.16.0.2 -g 3389
</code></pre>

<h2 id="netsh">netsh</h2>

<p>原理同 ew 中的 <code>lcx_tran</code></p>

<p>重启后依然生效</p>

<pre><code>netsh interface portproxy set v4tov4 listenaddress=192.168.1.101 listenport=1234 connectaddress=10.0.0.1 connectport=3389
</code></pre>

<p>删除</p>

<pre><code>netsh interface portproxy delete v4tov4 listenaddress=192.168.1.101 listenport=1234
</code></pre>

<p>关闭防火墙</p>

<pre><code>netsh firewall set opmode disabled
</code></pre>

<h2 id="portmap">portmap</h2>

<p>垃圾</p>

<p>listen</p>

<pre><code>client: ./portmap -m 2 -p1 1234 -p2 8888
</code></pre>

<p>slave</p>

<pre><code>server: ./portmap -m 3 -h1 192.168.1.100 -p1 8888 -h2 127.0.0.1 -p2 3389
</code></pre>

<p>tran</p>

<pre><code>server: ./portmap -m 1 -p1 1234 -h2 127.0.0.1 -p2 3389
</code></pre>

<h2 id="ssh">ssh</h2>

<pre><code>a: 192.168.1.100
b: 192.168.1.101,10.0.0.1
c: 10.0.0.2
</code></pre>

<h3 id="">本地端口转发</h3>

<pre><code>a: ssh  -CfNg -L 1234:10.0.0.2:3389 root@192.168.1.101
</code></pre>

<p>a 上 1234 端口的数据通过 b 被转发到 c 上的 3389 端口</p>

<h3 id="">远程端口转发</h3>

<pre><code>a: ssh CfNg -R 1234:192.168.1.100:3389 root@192.168.1.101
</code></pre>

<p>b 的 1234 端口的数据被转发到 a 上的 3389 端口, c 作为客户端访问 b</p>

<h3 id="socks">socks 代理</h3>

<pre><code>a: ssh -qTfnN -D 1080 192.168.1.101
</code></pre>

<p>a 上架设 socks 代理, 端口 1800, 数据通过 b 转发到内网的任何一台机器上</p>

<h2 id="portfwd">portfwd</h2>

<pre><code>portfwd add -l 1234 -r 192.168.1.100 -p 3389
</code></pre>

<p>删除</p>

<pre><code>portfwd del -l 1234
</code></pre>

<h2 id="reduhregeorgtunna">reDuh reGeorg Tunna</h2>

<p>略</p>
<!-- content end -->
</div>
<br>
<br>
    <div id="disqus_thread"></div>
	<div class="footer">
		<p>© Copyright 2017-2019 by X1r0z</p>
	</div>
</div>
<script src="main.js"></script>
<script id="content" type="text/mustache">
    <h1>{{title}}</h1>
    <div class="tag">
    {{date}}
    {{#tags}}
    <a href="/#/tag/{{name}}">#{{name}}</a>
    {{/tags}}
    </div>
</script>
<script id="pagesTemplate" type="text/mustache">
    {{#pages}}
    <li>
        <a href="{{path}}">{{title}}</a>
    </li>
    {{/pages}}
</script>
<script>
$(document).ready(function() {
    $.ajax({
        url: "main.json",
        type: "GET",
        dataType: "json",
        success: function(data) {
            $("#title").html(data.name);
            var pagesTemplate = Hogan.compile($("#pagesTemplate").html());
            var pagesHtml = pagesTemplate.render({"pages": data.pages});
            $("#pages").append(pagesHtml);
            //path
            var path = "port-forwarding.html";
            //path end
            var now = 0;
            for (var i = 0; i < data.posts.length; ++i)
                if (path == data.posts[i].path)
                    now = i;
            var post = data.posts[now];
            var tmp = post.tags.split(" ");
            var tags = [];
            for (var i = 0; i < tmp.length; ++i)
                if (tmp[i].length > 0)
                    tags.push({"name": tmp[i]});
            var contentTemplate = Hogan.compile($("#content").html());
            var contentHtml = contentTemplate.render({"title": post.title, "tags": tags, "date": post.date});
            $("#main").prepend(contentHtml);
            if (data.disqus_shortname.length > 0) {
                var disqus_shortname = data.disqus_shortname;
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            }
        }
    });
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ["\\(", "\\)"]], processEscapes: true}});
</script>
</body>
</html>
